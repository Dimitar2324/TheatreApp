@using TheatreApp.Web.ViewModels.Performance
@model IEnumerable<PerformanceIndexViewModel>

@{
	ViewData["Title"] = "Explore Performances";
}

@section Styles {
	<link rel="stylesheet" href="~/css/user-styles.css">
}

<div class="container mt-4">
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h1 class="text-light fw-bold">Explore Plays</h1>
		<a asp-controller="Home" asp-action="Index" class="btn btn-secondary fw-bold">
			<i class="bi bi-arrow-left">Back to Home Page</i>
		</a>
	</div>

	<div class="d-flex flex-column gap-2">
		@foreach (var performance in Model)
		{
			<div class="card shadow-lg border-0 rounded-3 d-flex flex-row align-items-center p-2"
				 style="height: 140px; max-height: 140px;">

				<img src="@performance.ImageUrl" class="rounded"
					 alt="@performance.PlayTitle"
					 style="width: 100px; height: 130px; object-fit: cover;">

				<div class="card-body ms-3 p-2 text-light" style="flex-grow: 1;">
					<h6 class="fw-bold mb-1 text-dark">@performance.PlayTitle</h6>
					<p class="text-muted mb-0" style="font-size: 0.85rem;">
						<strong>HallName:</strong> @performance.HallName |
						<strong>Available Tickets Count:</strong> @performance.AvailableTicketsCount 
					</p>
					<p class="text-muted mb-1" style="font-size: 0.85rem;">
						<strong>Start of the performance:</strong> @performance.StartTime
					</p>
				</div>

				<div class="me-3 d-flex gap-2">
					<a asp-controller="Play" asp-action="Details" asp-route-id="@performance.PlayId"
					   class="btn btn-primary btn-sm rounded-pill px-4 fw-bold">
						<i class="fas fa-eye">View Play's Details</i>
					</a>

					@if (User?.Identity?.IsAuthenticated ?? false)
					{
						<form asp-controller="Ticket" asp-action="Buy" method="get" class="d-inline">
							<input type="hidden" name="performanceId" value="@performance.Id" />
							<button type="submit" class="btn btn-warning btn-sm rounded-pill px-4 fw-bold">
								<i class="bi bi-bag">Buy ticket</i>
							</button>
						</form>
					}
				</div>
			</div>
		}
	</div>
</div>




